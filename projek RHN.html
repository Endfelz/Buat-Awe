<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Happy Birthday 10 Februari ðŸŽ‚ðŸ’™</title>
    <meta name="description" content="Ucapan ulang tahun lucu, aesthetic, modern, smooth, dan interaktif untuk 10 Februari.">
    <!-- Google Fonts: Cute, clean, friendly -->
    <link href="https://fonts.googleapis.com/css2?family=Quicksand:wght@400;700&family=Fredoka:wght@500;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --baby-blue: #cbeafe;
            --sky-blue: #e3f6ff;
            --pastel-blue: #d0f1ff;
            --pastel-pink: #ffd6ec;
            --pastel-lavender: #f3e8ff;
            --pastel-yellow: #fff9c4;
            --pastel-purple: #e6e6fa;
            --pastel-white: #fafdff;
            --soft-white: #fafdff;
            --soft-shadow: 0 4px 24px 0 rgba(120,180,255,0.12);
            --main-font: 'Quicksand', 'Fredoka', 'Nunito', Arial, sans-serif;
            --header-size: 2.2rem;
            --card-radius: 20px;
            --transition: 0.3s cubic-bezier(.77,0,.18,1);
        }
        html, body {
            margin: 0;
            padding: 0;
            min-height: 100%;
            background: linear-gradient(135deg, var(--baby-blue) 0%, var(--pastel-pink) 100%);
            font-family: var(--main-font);
            color: #2d3a4a;
            scroll-behavior: smooth;
            overflow-x: hidden;
        }
        body {
            position: relative;
        }
        header {
            text-align: center;
            padding: 48px 10px 24px 10px;
            background: transparent;
            position: relative;
            z-index: 2;
        }
        .main-title {
            font-size: var(--header-size);
            font-family: 'Fredoka', 'Nunito', var(--main-font);
            color: #3a5ca8;
            letter-spacing: 1px;
            margin-bottom: 8px;
            font-weight: 700;
            text-shadow: 0 2px 8px #b3e0ff80;
        }
        .subtitle {
            font-size: 1.1rem;
            color: #e75480;
            margin-bottom: 0;
            font-family: 'Nunito', var(--main-font);
        }
        nav {
            display: flex;
            justify-content: center;
            gap: 12px;
            margin: 0 0 18px 0;
            flex-wrap: wrap;
        }
        nav a {
            background: var(--pastel-blue);
            color: #e75480;
            padding: 8px 18px;
            border-radius: 999px;
            text-decoration: none;
            font-weight: 700;
            font-size: 1rem;
            box-shadow: var(--soft-shadow);
            margin: 4px 0;
            transition: background var(--transition), color var(--transition), transform var(--transition);
            cursor: pointer;
            font-family: 'Nunito', var(--main-font);
        }
        nav a:hover, nav a.active {
            background: var(--pastel-pink);
            color: #b36fae;
            transform: scale(1.07) rotate(-2deg);
        }
        .container {
            max-width: 700px;
            margin: 0 auto 90px auto;
            padding: 0 12px;
        }
        .card {
            background: var(--pastel-white);
            border-radius: var(--card-radius);
            box-shadow: var(--soft-shadow);
            margin-bottom: 28px;
            padding: 24px 18px 18px 18px;
            position: relative;
            overflow: hidden;
            transition: box-shadow var(--transition), transform var(--transition);
            border: 2.5px solid #f3e8ff;
        }
        .card.cute {
            border: 2.5px dashed #ffd6ec;
        }
        .card .card-title {
            font-size: 1.3rem;
            font-weight: 700;
            color: #e75480;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 8px;
            font-family: 'Fredoka', 'Nunito', var(--main-font);
        }
        .card .card-title .icon {
            font-size: 1.4em;
        }
        .countdown-cute-wrap {
            display: flex;
            justify-content: center;
            gap: 18px;
            margin-top: 10px;
            margin-bottom: 0;
            position: relative;
            z-index: 2;
        }
        .countdown-bubble {
            background: linear-gradient(135deg, #fafdffcc 60%, #ffd6ecbb 100%);
            box-shadow: 0 4px 24px 0 rgba(120,180,255,0.18), 0 0 0 4px #ffd6ec33;
            border-radius: 22px;
            border: 2.5px solid #ffd6ec;
            min-width: 70px;
            min-height: 90px;
            padding: 12px 10px 8px 10px;
            display: flex;
            flex-direction: column;
            align-items: center;
            font-family: 'Fredoka', 'Quicksand', 'Nunito', Arial, sans-serif;
            font-size: 2.1rem;
            font-weight: 700;
            color: #b36fae;
            position: relative;
            overflow: visible;
            transition: box-shadow 0.3s, border 0.3s;
            backdrop-filter: blur(8px) saturate(1.2);
            animation: floatBubble 3.2s ease-in-out infinite alternate;
        }
        @keyframes floatBubble {
            0% { transform: translateY(0);}
            100% { transform: translateY(-10px);}
        }
        .countdown-bubble .cd-label {
            font-size: 1.01rem;
            color: #e75480;
            font-weight: 600;
            margin-top: 6px;
            letter-spacing: 0.5px;
            text-shadow: 0 1px 6px #ffd6ec55;
        }
        .countdown-bubble .cd-num {
            display: block;
            font-size: 2.3rem;
            font-family: 'Fredoka', 'Quicksand', 'Nunito', Arial, sans-serif;
            font-weight: 700;
            color: #3a5ca8;
            text-shadow: 0 2px 12px #ffd6ec55, 0 0px 8px #fff9c4aa;
            transition: color 0.3s;
            will-change: contents, transform;
            position: relative;
            min-width: 38px;
            min-height: 38px;
            line-height: 1.1;
        }
        .countdown-bubble .cd-num.flip {
            animation: flipNum 0.6s cubic-bezier(.77,0,.18,1);
        }
        @keyframes flipNum {
            0% { transform: rotateX(0deg);}
            40% { transform: rotateX(90deg);}
            60% { transform: rotateX(90deg);}
            100% { transform: rotateX(0deg);}
        }
        .countdown-bubble .cd-num.pulse {
            animation: pulseNum 0.5s cubic-bezier(.77,0,.18,1);
        }
        @keyframes pulseNum {
            0% { box-shadow: 0 0 0 0 #ffd6ec88;}
            70% { box-shadow: 0 0 0 10px #ffd6ec22;}
            100% { box-shadow: 0 0 0 0 #ffd6ec00;}
        }
        .countdown-bubble.glow {
            box-shadow: 0 0 16px 4px #ffd6ec88, 0 4px 24px 0 rgba(120,180,255,0.18);
            border-color: #fff9c4;
        }
        .countdown-bubble .cd-sparkle {
            position: absolute;
            left: 50%; top: 12px;
            transform: translateX(-50%);
            pointer-events: none;
            z-index: 2;
            font-size: 1.1em;
            opacity: 0.8;
            animation: sparkleFade 0.7s forwards;
        }
        .countdown-bubble .cd-heart {
            position: absolute;
            right: 10px; bottom: 10px;
            font-size: 1.1em;
            opacity: 0.7;
            animation: sparkleFade 0.9s 0.2s forwards;
        }
        .countdown-bubble .cd-star {
            position: absolute;
            left: 10px; bottom: 10px;
            font-size: 1.1em;
            opacity: 0.7;
            animation: sparkleFade 0.9s 0.1s forwards;
        }
        @media (max-width:600px) {
            .countdown-cute-wrap { gap: 7px;}
            .countdown-bubble { min-width: 48px; min-height: 60px; font-size: 1.1rem; padding: 7px 4px 4px 4px;}
            .countdown-bubble .cd-num { font-size: 1.3rem; min-width: 22px; min-height: 22px;}
            .countdown-bubble .cd-label { font-size: 0.8rem;}
        }
        html, body {
            margin: 0;
            padding: 0;
            min-height: 100%;
            background: linear-gradient(135deg, var(--baby-blue) 0%, var(--pastel-pink) 100%);
            font-family: var(--main-font);
            color: #2d3a4a;
            scroll-behavior: smooth;
            overflow-x: hidden;
        }
        body {
            position: relative;
        }
        header {
            text-align: center;
            padding: 48px 10px 24px 10px;
            background: transparent;
            position: relative;
            z-index: 2;
        }
        .main-title {
            font-size: var(--header-size);
            font-family: 'Fredoka', 'Nunito', var(--main-font);
            color: #3a5ca8;
            letter-spacing: 1px;
            margin-bottom: 8px;
            font-weight: 700;
            text-shadow: 0 2px 8px #b3e0ff80;
        }
        .subtitle {
            font-size: 1.1rem;
            color: #e75480;
            margin-bottom: 0;
            font-family: 'Nunito', var(--main-font);
        }
        nav {
            display: flex;
            justify-content: center;
            gap: 12px;
            margin: 0 0 18px 0;
            flex-wrap: wrap;
        }
        nav a {
            background: var(--pastel-blue);
            color: #e75480;
            padding: 8px 18px;
            border-radius: 999px;
            text-decoration: none;
            font-weight: 700;
            font-size: 1rem;
            box-shadow: var(--soft-shadow);
            margin: 4px 0;
            transition: background var(--transition), color var(--transition), transform var(--transition);
            cursor: pointer;
            font-family: 'Nunito', var(--main-font);
        }
        nav a:hover, nav a.active {
            background: var(--pastel-pink);
            color: #b36fae;
            transform: scale(1.07) rotate(-2deg);
        }
        .container {
            max-width: 700px;
            margin: 0 auto 90px auto;
            padding: 0 12px;
        }
        .card {
            background: var(--pastel-white);
            border-radius: var(--card-radius);
            box-shadow: var(--soft-shadow);
            margin-bottom: 28px;
            padding: 24px 18px 18px 18px;
            position: relative;
            overflow: hidden;
            transition: box-shadow var(--transition), transform var(--transition);
            border: 2.5px solid #f3e8ff;
        }
        .card.cute {
            border: 2.5px dashed #ffd6ec;
        }
        .card .card-title {
            font-size: 1.3rem;
            font-weight: 700;
            color: #e75480;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 8px;
            font-family: 'Fredoka', 'Nunito', var(--main-font);
        }
        .card .card-title .icon {
            font-size: 1.4em;
        }
        .motivasi-list {
            margin: 0;
            padding: 0 0 0 18px;
            font-size: 1.08rem;
        }
        .motivasi-list li {
            margin-bottom: 8px;
            color: #b36fae;
            font-family: 'Nunito', var(--main-font);
        }
        .gallery {
            display: flex;
            gap: 12px;
            flex-wrap: wrap;
            justify-content: center;
        }
        .gallery img {
            width: 110px;
            height: 110px;
            object-fit: cover;
            border-radius: 18px;
            box-shadow: 0 2px 12px #ffd6ec40;
            background: var(--pastel-blue);
            margin-bottom: 8px;
            transition: transform var(--transition);
            border: 2px solid #ffd6ec;
        }
        .gallery img:hover {
            transform: scale(1.07) rotate(-2deg);
        }
        .music-toggle {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 8px;
        }
        .music-toggle button {
            background: var(--pastel-pink);
            border: none;
            border-radius: 999px;
            padding: 8px 18px;
            font-size: 1rem;
            font-weight: 700;
            color: #b36fae;
            cursor: pointer;
            box-shadow: var(--soft-shadow);
            transition: background var(--transition), color var(--transition), transform var(--transition);
            font-family: 'Nunito', var(--main-font);
        }
        .music-toggle button.active {
            background: var(--pastel-blue);
            color: #e75480;
            transform: scale(1.07);
        }
        .form-ucapan {
            display: flex;
            flex-direction: column;
            gap: 10px;
            margin-top: 8px;
        }
        .form-ucapan input, .form-ucapan textarea {
            border: 1.5px solid #ffd6ec;
            border-radius: 12px;
            padding: 8px 12px;
            font-size: 1rem;
            font-family: 'Nunito', var(--main-font);
            background: #fafdff;
            resize: none;
            transition: border var(--transition);
        }
        .form-ucapan input:focus, .form-ucapan textarea:focus {
            border: 1.5px solid #e75480;
            outline: none;
        }
        .form-ucapan button {
            align-self: flex-end;
            background: var(--pastel-pink);
            color: #b36fae;
            border: none;
            border-radius: 999px;
            padding: 8px 18px;
            font-size: 1rem;
            font-weight: 700;
            cursor: pointer;
            box-shadow: var(--soft-shadow);
            transition: background var(--transition), color var(--transition), transform var(--transition);
            font-family: 'Nunito', var(--main-font);
        }
        .form-ucapan button:active {
            background: var(--pastel-blue);
            color: #e75480;
            transform: scale(1.07);
        }
        .ucapan-list {
            margin-top: 18px;
            max-height: 180px;
            overflow-y: auto;
            padding-right: 4px;
        }
        .ucapan-item {
            background: var(--pastel-lavender);
            border-radius: 12px;
            padding: 10px 14px;
            margin-bottom: 10px;
            font-size: 1rem;
            box-shadow: 0 2px 8px #ffd6ec30;
            position: relative;
            border: 1.5px solid #ffd6ec;
        }
        .ucapan-item .ucapan-nama {
            font-weight: 700;
            color: #e75480;
            margin-bottom: 2px;
        }
        .ucapan-item .ucapan-tgl {
            font-size: 0.85em;
            color: #b36fae;
            position: absolute;
            right: 12px;
            bottom: 6px;
        }
        .fireworks-btn {
            display: flex;
            align-items: center;
            gap: 8px;
            background: var(--pastel-pink);
            color: #e75480;
            border: none;
            border-radius: 999px;
            padding: 10px 22px;
            font-size: 1.1rem;
            font-weight: 700;
            cursor: pointer;
            box-shadow: var(--soft-shadow);
            margin: 0 auto 18px auto;
            transition: background var(--transition), color var(--transition), transform var(--transition);
            font-family: 'Nunito', var(--main-font);
        }
        .fireworks-btn:active {
            background: var(--pastel-blue);
            color: #b36fae;
            transform: scale(1.07);
        }
        .fireworks-canvas {
            position: fixed;
            left: 0; top: 0;
            width: 100vw; height: 100vh;
            pointer-events: none;
            z-index: 100;
        }
        .story-section {
            margin-top: 18px;
        }
        .story-form {
            display: flex;
            flex-direction: column;
            gap: 8px;
            margin-bottom: 12px;
        }
        .story-form textarea {
            border: 1.5px solid #ffd6ec;
            border-radius: 12px;
            padding: 8px 12px;
            font-size: 1rem;
            font-family: 'Nunito', var(--main-font);
            background: #fafdff;
            min-height: 60px;
            resize: vertical;
        }
        .story-form .story-btns {
            display: flex;
            gap: 8px;
        }
        .story-form button {
            background: var(--pastel-pink);
            color: #b36fae;
            border: none;
            border-radius: 999px;
            padding: 7px 16px;
            font-size: 1rem;
            font-weight: 700;
            cursor: pointer;
            box-shadow: var(--soft-shadow);
            transition: background var(--transition), color var(--transition), transform var(--transition);
            font-family: 'Nunito', var(--main-font);
        }
        .story-form button:active {
            background: var(--pastel-blue);
            color: #e75480;
            transform: scale(1.07);
        }
        .story-list {
            max-height: 180px;
            overflow-y: auto;
            display: flex;
            flex-direction: column;
            gap: 10px;
        }
        .story-card {
            background: var(--pastel-lavender);
            border-radius: 14px;
            padding: 12px 14px 8px 14px;
            box-shadow: 0 2px 8px #ffd6ec30;
            position: relative;
            font-size: 1rem;
            transition: box-shadow var(--transition), transform var(--transition);
            border: 1.5px solid #ffd6ec;
        }
        .story-card .story-date {
            font-size: 0.85em;
            color: #b36fae;
            position: absolute;
            right: 12px;
            bottom: 6px;
        }
        .story-card .story-actions {
            position: absolute;
            top: 8px;
            right: 12px;
            display: flex;
            gap: 6px;
        }
        .story-card .story-actions button {
            background: transparent;
            border: none;
            color: #e75480;
            font-size: 1.1em;
            cursor: pointer;
            padding: 2px 4px;
            border-radius: 6px;
            transition: background var(--transition);
        }
        .story-card .story-actions button:hover {
            background: #ffd6ec80;
        }
        .save-success {
            color: #e75480;
            background: #ffd6ec;
            border-radius: 8px;
            padding: 4px 10px;
            font-size: 0.98em;
            margin-bottom: 6px;
            display: inline-block;
            animation: fadeInZoom 0.7s;
        }
        @keyframes fadeInZoom {
            0% { opacity: 0; transform: scale(0.7);}
            100% { opacity: 1; transform: scale(1);}
        }
        /* Opening animation */
        .opening-anim {
            position: fixed;
            left: 0; top: 0;
            width: 100vw; height: 100vh;
            background: linear-gradient(135deg, #cbeafe 0%, #ffd6ec 100%);
            z-index: 9999;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-direction: column;
            animation: fadeOut 1.2s 2.2s forwards;
        }
        .opening-anim .opening-text {
            font-size: 2.7rem;
            font-family: 'Fredoka', 'Nunito', var(--main-font);
            color: #e75480;
            font-weight: 700;
            opacity: 0;
            transform: scale(0.7);
            animation: fadeInZoom 1.2s 0.2s forwards;
            text-shadow: 0 2px 16px #ffd6ec80;
        }
        @keyframes fadeOut {
            to { opacity: 0; pointer-events: none; }
        }
        /* Cute background elements */
        .bg-cloud, .bg-star, .bg-bubble, .bg-flower, .bg-ribbon {
            position: absolute;
            pointer-events: none;
            z-index: 0;
        }
        .bg-cloud {
            width: 120px; height: 60px;
            background: #fff;
            border-radius: 60px 60px 60px 60px / 40px 40px 60px 60px;
            opacity: 0.7;
            box-shadow: 40px 0 60px #ffd6ec40;
            animation: cloudMove 60s linear infinite;
        }
        .bg-cloud.c2 { left: 60vw; top: 12vh; width: 90px; height: 40px; opacity: 0.5; animation-duration: 70s;}
        .bg-cloud.c3 { left: 20vw; top: 30vh; width: 70px; height: 30px; opacity: 0.6; animation-duration: 80s;}
        .bg-cloud.c4 { left: 80vw; top: 60vh; width: 100px; height: 50px; opacity: 0.4; animation-duration: 90s;}
        @keyframes cloudMove {
            0% { transform: translateX(-10vw);}
            100% { transform: translateX(110vw);}
        }
        .bg-star {
            width: 18px; height: 18px;
            background: radial-gradient(circle, #fff 60%, #ffd6ec 100%);
            border-radius: 50%;
            opacity: 0.7;
            animation: starBlink 2.5s infinite alternate;
        }
        .bg-star.s2 { left: 20vw; top: 10vh; animation-delay: 0.7s;}
        .bg-star.s3 { left: 70vw; top: 20vh; animation-delay: 1.2s;}
        .bg-star.s4 { left: 50vw; top: 60vh; animation-delay: 0.3s;}
        @keyframes starBlink {
            0% { opacity: 0.7;}
            100% { opacity: 0.2;}
        }
        .bg-bubble {
            width: 32px; height: 32px;
            background: radial-gradient(circle, #ffd6ec 60%, #cbeafe 100%);
            border-radius: 50%;
            opacity: 0.4;
            animation: bubbleFloat 12s linear infinite;
        }
        .bg-bubble.b2 { left: 30vw; top: 80vh; width: 22px; height: 22px; animation-duration: 14s;}
        .bg-bubble.b3 { left: 80vw; top: 50vh; width: 28px; height: 28px; animation-duration: 10s;}
        @keyframes bubbleFloat {
            0% { transform: translateY(0);}
            100% { transform: translateY(-60vh);}
        }
        /* Balloon floating */
        .balloon {
            position: absolute;
            z-index: 1;
            width: 38px; height: 54px;
            left: 10vw; top: 80vh;
            animation: balloonFloat 18s linear infinite;
        }
        .balloon.b2 { left: 60vw; top: 85vh; animation-duration: 22s;}
        .balloon.b3 { left: 35vw; top: 90vh; animation-duration: 20s;}
        @keyframes balloonFloat {
            0% { transform: translateY(0);}
            100% { transform: translateY(-90vh);}
        }
        /* Floating cloud effect (girly parallax) */
        .float-cloud {
            position: fixed;
            top: 10vh;
            left: -80px;
            width: 120px;
            height: 60px;
            background: #fff;
            border-radius: 60px 60px 60px 60px / 40px 40px 60px 60px;
            opacity: 0.55;
            box-shadow: 40px 0 60px #ffd6ec40;
            animation: floatCloudLeft 32s linear infinite;
            z-index: 1;
        }
        .float-cloud.right {
            left: auto;
            right: -80px;
            top: 30vh;
            animation: floatCloudRight 38s linear infinite;
            opacity: 0.45;
        }
        @keyframes floatCloudLeft {
            0% { left: -80px;}
            100% { left: 100vw;}
        }
        @keyframes floatCloudRight {
            0% { right: -80px;}
            100% { right: 100vw;}
        }
        /* Ribbon animation */
        .bg-ribbon {
            width: 80px; height: 24px;
            left: 8vw; top: 3vh;
            background: linear-gradient(90deg, #ffd6ec 60%, #f3e8ff 100%);
            border-radius: 16px 16px 24px 24px;
            opacity: 0.7;
            animation: ribbonWave 5s ease-in-out infinite alternate;
        }
        .bg-ribbon.r2 { left: 80vw; top: 7vh; width: 60px; height: 18px; opacity: 0.5; animation-delay: 2s;}
        @keyframes ribbonWave {
            0% { transform: rotate(-5deg) scaleY(1);}
            100% { transform: rotate(7deg) scaleY(1.1);}
        }
        /* Flower petal falling */
        .bg-flower {
            width: 22px; height: 22px;
            left: 15vw; top: -30px;
            background: url('https://cdn.jsdelivr.net/gh/twitter/twemoji@14.0.2/assets/svg/1f338.svg') no-repeat center/contain;
            opacity: 0.7;
            animation: flowerFall 12s linear infinite;
        }
        .bg-flower.f2 { left: 60vw; animation-duration: 15s; opacity: 0.5;}
        .bg-flower.f3 { left: 80vw; animation-duration: 10s; opacity: 0.6;}
        @keyframes flowerFall {
            0% { top: -30px;}
            100% { top: 110vh;}
        }
        /* Mascot (bunny) */
        .mascot {
            width: 70px;
            height: 70px;
            border-radius: 50%;
            background: #fff8e1;
            border: 3px solid #ffd6ec;
            box-shadow: 0 2px 12px #ffd6ec40;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 10px auto;
            position: relative;
            overflow: visible;
        }
        .mascot-face {
            width: 48px; height: 48px;
            border-radius: 50%;
            background: #fff;
            border: 2px solid #ffd6ec;
            position: relative;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .mascot-face::before, .mascot-face::after {
            content: '';
            position: absolute;
            width: 10px; height: 22px;
            background: #fff;
            border-radius: 50% 50% 60% 60% / 60% 60% 100% 100%;
            border: 2px solid #ffd6ec;
            top: -18px;
        }
        .mascot-face::before { left: 4px;}
        .mascot-face::after { right: 4px;}
        .mascot-mouth {
            width: 16px; height: 8px;
            border-radius: 0 0 16px 16px / 0 0 8px 8px;
            background: #e75480;
            position: absolute;
            bottom: 10px; left: 50%;
            transform: translateX(-50%);
        }
        /* Cake animation */
        .cake {
            width: 70px; height: 70px;
            margin: 0 auto 10px auto;
            position: relative;
            display: block;
        }
        .cake-base {
            width: 70px; height: 30px;
            background: #fff;
            border-radius: 0 0 20px 20px;
            border: 2px solid #ffd6ec;
            position: absolute; bottom: 0; left: 0;
        }
        .cake-top {
            width: 70px; height: 18px;
            background: #ffd6ec;
            border-radius: 20px 20px 12px 12px / 18px 18px 12px 12px;
            border: 2px solid #ffd6ec;
            position: absolute; top: 0; left: 0;
        }
        .cake-candle {
            width: 8px; height: 18px;
            background: #e75480;
            border-radius: 4px;
            position: absolute; top: -16px; left: 31px;
            box-shadow: 0 2px 8px #ffd6ec80;
        }
        .cake-flame {
            width: 8px; height: 12px;
            background: radial-gradient(circle at 50% 60%, #fff9c4 60%, #ffd700 100%);
            border-radius: 50% 50% 60% 60% / 60% 60% 100% 100%;
            position: absolute; top: -22px; left: 31px;
            animation: flameFlicker 1.2s infinite alternate;
        }
        @keyframes flameFlicker {
            0% { transform: scaleY(1);}
            100% { transform: scaleY(1.2);}
        }
        /* Confetti */
        .confetti {
            position: fixed;
            left: 0; top: 0;
            width: 100vw; height: 100vh;
            pointer-events: none;
            z-index: 1000;
        }
        /* Surprise box */
        .surprise-box {
            width: 60px; height: 60px;
            background: #fff;
            border: 2px solid #ffd6ec;
            border-radius: 16px;
            position: relative;
            margin: 0 auto 10px auto;
            cursor: pointer;
            box-shadow: 0 2px 12px #ffd6ec40;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: transform var(--transition);
        }
        .surprise-box:active {
            transform: scale(1.07) rotate(-2deg);
        }
        .surprise-lid {
            width: 60px; height: 16px;
            background: #ffd6ec;
            border-radius: 16px 16px 8px 8px;
            border: 2px solid #ffd6ec;
            position: absolute; top: -16px; left: 0;
            transition: transform 0.5s cubic-bezier(.77,0,.18,1);
        }
        .surprise-box.open .surprise-lid {
            transform: translateY(-30px) rotate(-15deg);
        }
        .surprise-msg {
            position: absolute;
            left: 50%; top: 50%;
            transform: translate(-50%, -50%) scale(0.7);
            opacity: 0;
            background: var(--pastel-yellow);
            color: #e75480;
            border-radius: 10px;
            padding: 10px 18px;
            font-size: 1.1rem;
            font-weight: 700;
            box-shadow: 0 2px 12px #ffd6ec80;
            pointer-events: none;
            transition: opacity 0.4s, transform 0.4s;
        }
        .surprise-box.open .surprise-msg {
            opacity: 1;
            transform: translate(-50%, -70%) scale(1.1);
        }
        /* Theme switcher */
        .theme-switcher {
            position: fixed;
            right: 16px; bottom: 70px;
            z-index: 100;
            background: var(--pastel-pink);
            border-radius: 999px;
            box-shadow: var(--soft-shadow);
            padding: 8px 12px;
            display: flex;
            align-items: center;
            gap: 8px;
            cursor: pointer;
            font-size: 1.1rem;
            font-weight: 700;
            color: #e75480;
            transition: background var(--transition), color var(--transition);
            font-family: 'Nunito', var(--main-font);
        }
        .theme-switcher.night {
            background: #b3b8f8;
            color: #fff;
        }
        /* Background switcher */
        #bgSwitcher {
            position: fixed;
            right: 16px;
            bottom: 120px;
            z-index: 100;
            background: var(--pastel-blue);
            border-radius: 999px;
            box-shadow: var(--soft-shadow);
            padding: 8px 12px;
            display: flex;
            align-items: center;
            gap: 8px;
            cursor: pointer;
            font-size: 1.1rem;
            font-weight: 700;
            color: #b36fae;
            transition: background var(--transition), color var(--transition);
            font-family: 'Nunito', var(--main-font);
        }
        /* Sparkle effect */
        .sparkle {
            position: fixed;
            pointer-events: none;
            z-index: 9999;
            width: 18px; height: 18px;
            background: radial-gradient(circle, #fff 60%, #ffd6ec 100%);
            border-radius: 50%;
            opacity: 0.8;
            animation: sparkleFade 0.7s forwards;
        }
        @keyframes sparkleFade {
            0% { opacity: 0.8; transform: scale(1);}
            100% { opacity: 0; transform: scale(1.7);}
        }
        /* Love/star click effect */
        .click-effect {
            position: fixed;
            pointer-events: none;
            z-index: 9999;
            font-size: 1.5rem;
            opacity: 0.8;
            animation: clickPop 0.7s forwards;
        }
        @keyframes clickPop {
            0% { opacity: 0.8; transform: scale(1);}
            100% { opacity: 0; transform: scale(1.7) translateY(-30px);}
        }
        /* Walking Bear Effect */
        .walking-bear {
            position: fixed;
            z-index: 4;
            width: 54px;
            height: 44px;
            left: 0vw;
            bottom: 4vh;
            pointer-events: none;
            opacity: 0.98;
            /* Cute bear SVG */
            background: url('data:image/svg+xml;utf8,<svg width="54" height="44" viewBox="0 0 54 44" fill="none" xmlns="http://www.w3.org/2000/svg"><ellipse cx="27" cy="28" rx="18" ry="13" fill="%23bfa97a"/><ellipse cx="15" cy="14" rx="7" ry="7" fill="%23bfa97a"/><ellipse cx="39" cy="14" rx="7" ry="7" fill="%23bfa97a"/><ellipse cx="27" cy="28" rx="14" ry="10" fill="%23fff"/><ellipse cx="22" cy="28" rx="2.2" ry="2.2" fill="%233a5ca8"/><ellipse cx="32" cy="28" rx="2.2" ry="2.2" fill="%233a5ca8"/><ellipse cx="27" cy="34" rx="2.8" ry="1.2" fill="%23e75480"/><ellipse cx="10" cy="10" rx="2.2" ry="2.2" fill="%23bfa97a"/><ellipse cx="44" cy="10" rx="2.2" ry="2.2" fill="%23bfa97a"/><rect x="13" y="37" width="6" height="4" rx="2" fill="%23bfa97a"/><rect x="35" y="37" width="6" height="4" rx="2" fill="%23bfa97a"/></svg>') no-repeat center/contain;
            transition: transform 0.5s;
            animation: bearWalk 0.7s infinite alternate, bearWiggle 1.2s infinite ease-in-out;
        }
        @keyframes bearWalk {
            0% { transform: scaleY(1) translateY(0) scaleX(1);}
            100% { transform: scaleY(1.04) translateY(-3px) scaleX(1);}
        }
        @keyframes bearWiggle {
            0% { filter: drop-shadow(0 0 0 #bfa97a);}
            20% { filter: drop-shadow(-2px 0 0 #bfa97a);}
            50% { filter: drop-shadow(2px 0 0 #bfa97a);}
            80% { filter: drop-shadow(-2px 0 0 #bfa97a);}
            100% { filter: drop-shadow(0 0 0 #bfa97a);}
        }
        .walking-bear.lift-left {
            /* efek kaki kiri naik */
            filter: drop-shadow(-2px 2px 0 #bfa97a);
        }
        .walking-bear.lift-right {
            /* efek kaki kanan naik */
            filter: drop-shadow(2px 2px 0 #bfa97a);
        }
        /* Responsive for bear */
        @media (max-width: 600px) {
            .walking-bear { width: 36px; height: 28px; bottom: 2vh;}
        }
        /* Walking Bunny Mascot */
        .walking-bunny {
            position: fixed;
            z-index: 4;
            width: 48px;
            height: 48px;
            left: 0vw;
            bottom: 10vh;
            pointer-events: none;
            opacity: 0.98;
            background: url('data:image/svg+xml;utf8,<svg width="48" height="48" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg"><ellipse cx="24" cy="28" rx="16" ry="13" fill="%23fff8e1"/><ellipse cx="14" cy="14" rx="7" ry="13" fill="%23fff"/><ellipse cx="34" cy="14" rx="7" ry="13" fill="%23fff"/><ellipse cx="24" cy="28" rx="12" ry="10" fill="%23fff"/><ellipse cx="19" cy="28" rx="2.2" ry="2.2" fill="%23e75480"/><ellipse cx="29" cy="28" rx="2.2" ry="2.2" fill="%23e75480"/><ellipse cx="24" cy="34" rx="2.8" ry="1.2" fill="%23e75480"/><ellipse cx="10" cy="10" rx="2.2" ry="2.2" fill="%23fff"/><ellipse cx="38" cy="10" rx="2.2" ry="2.2" fill="%23fff"/><rect x="12" y="37" width="6" height="4" rx="2" fill="%23fff8e1"/><rect x="30" y="37" width="6" height="4" rx="2" fill="%23fff8e1"/></svg>') no-repeat center/contain;
            transition: transform 0.5s;
            animation: bunnyWalk 0.7s infinite alternate, bunnyWiggle 1.2s infinite ease-in-out;
        }
        @keyframes bunnyWalk {
            0% { transform: scaleY(1) translateY(0) scaleX(1);}
            100% { transform: scaleY(1.04) translateY(-3px) scaleX(1);}
        }
        @keyframes bunnyWiggle {
            0% { filter: drop-shadow(0 0 0 #fff8e1);}
            20% { filter: drop-shadow(-2px 0 0 #fff8e1);}
            50% { filter: drop-shadow(2px 0 0 #fff8e1);}
            80% { filter: drop-shadow(-2px 0 0 #fff8e1);}
            100% { filter: drop-shadow(0 0 0 #fff8e1);}
        }
        .walking-bunny.lift-left { filter: drop-shadow(-2px 2px 0 #fff8e1);}
        .walking-bunny.lift-right { filter: drop-shadow(2px 2px 0 #fff8e1);}
        @media (max-width: 600px) {
            .walking-bunny { width: 32px; height: 32px; bottom: 6vh;}
        }
        .walking-bunny::after {
            content: '';
            position: absolute;
            left: 8px; right: 8px; bottom: -7px;
            height: 8px;
            border-radius: 50%;
            background: linear-gradient(90deg, #b3e0ff 0%, #b6e2a1 60%, #b3e0ff 100%);
            opacity: 0.7;
            z-index: -1;
        }
        /* Responsive */
        @media (max-width: 600px) {
            .container { padding: 0 2vw;}
            .main-title { font-size: 1.5rem;}
            .card { padding: 14px 6px 10px 6px;}
            .gallery img { width: 80px; height: 80px;}
            .cake, .mascot { width: 50px; height: 50px;}
            .float-cloud, .float-cloud.right { width: 70px; height: 36px;}
        }
        /* Night mode */
        body.night {
            background: linear-gradient(135deg, #b3b8f8 0%, #f3e8ff 100%);
            color: #222;
        }
        body.night .card { background: #f3e8ff;}
        body.night nav a { background: #b3b8f8; color: #fff;}
        body.night nav a:hover, body.night nav a.active { background: #ffd6ec; color: #e75480;}
        body.night .fireworks-btn { background: #b3b8f8; color: #fff;}
        body.night .fireworks-btn:active { background: #ffd6ec; color: #e75480;}
        body.night .theme-switcher { background: #b3b8f8; color: #fff;}
        body.night .theme-switcher.night { background: #ffd6ec; color: #e75480;}
        body.night .story-card, body.night .ucapan-item { background: #e6e6fa;}
        body.night .gallery img { background: #e6e6fa;}
        body.night .mascot { background: #f3e8ff;}
        body.night .cake-base, body.night .cake-top { background: #f3e8ff;}
        body.night .cake-candle { background: #b3b8f8;}
        body.night .cake-flame { background: radial-gradient(circle at 50% 60%, #fff9c4 60%, #ffd700 100%);}
        /* Flying Bird Effect */
        .flying-bird {
            position: fixed;
            z-index: 3;
            width: 38px;
            height: 28px;
            top: 16vh;
            left: 0vw;
            pointer-events: none;
            opacity: 0.92;
            background: url('data:image/svg+xml;utf8,<svg width="38" height="28" viewBox="0 0 38 28" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M2 18 Q12 8 22 18 Q28 24 36 18" stroke="%233a5ca8" stroke-width="2" fill="none"/><ellipse cx="10" cy="16" rx="4" ry="2.2" fill="%23b3e0ff"/><ellipse cx="28" cy="16" rx="4" ry="2.2" fill="%23b3e0ff"/><ellipse cx="19" cy="18" rx="6" ry="3.2" fill="%23fff"/><circle cx="22" cy="17" r="1.1" fill="%233a5ca8"/><circle cx="16" cy="17" r="1.1" fill="%233a5ca8"/><ellipse cx="19" cy="21" rx="1.2" ry="0.5" fill="%23e75480"/></svg>') no-repeat center/contain;
            transition: transform 0.5s;
            animation: birdFlap 0.7s infinite alternate;
        }
        @keyframes birdFlap {
            0% { transform: scaleY(1) translateY(0);}
            100% { transform: scaleY(1.08) translateY(-4px);}
        }
        /* Responsive for birds */
        @media (max-width: 600px) {
            .flying-bird { width: 26px; height: 18px; top: 13vh;}
        }
        /* Kawaii Small Bear (bottom walker) */
        .kawaii-bear {
            position: fixed;
            z-index: 5;
            width: 44px;
            height: 44px;
            left: 0vw;
            bottom: 1.5vh;
            pointer-events: auto;
            opacity: 1;
            background: none;
            transition: filter 0.3s;
            will-change: left, bottom, filter;
        }
        .kawaii-bear .bear-svg {
            width: 100%; height: 100%;
            display: block;
            pointer-events: none;
            filter: drop-shadow(0 2px 6px #bfa97a33);
        }
        .kawaii-bear.smile .bear-face { filter: brightness(1.2) drop-shadow(0 0 6px #ffd6ec); }
        .kawaii-bear .love {
            position: absolute;
            left: 50%; top: 0;
            transform: translate(-50%, -80%) scale(0.7);
            font-size: 1.3em;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.3s, transform 0.3s;
        }
        .kawaii-bear.love .love {
            opacity: 1;
            transform: translate(-50%, -120%) scale(1.2);
        }
        .kawaii-bear .bear-shadow {
            position: absolute;
            left: 8px; right: 8px; bottom: -6px;
            height: 8px;
            border-radius: 50%;
            background: #b6e2a1;
            opacity: 0.5;
            z-index: -1;
        }
        /* Bear walk animation */
        .kawaii-bear.walk .bear-leg-left { transform: rotate(-18deg) translateY(2px);}
        .kawaii-bear.walk .bear-leg-right { transform: rotate(18deg) translateY(2px);}
        .kawaii-bear.idle .bear-leg-left,
        .kawaii-bear.idle .bear-leg-right { transform: rotate(0deg);}
        .kawaii-bear.wave .bear-arm-right { transform: rotate(-35deg) translateY(-2px);}
        .kawaii-bear.sit .bear-body { transform: scaleY(0.92) translateY(6px);}
        .kawaii-bear.jump { animation: bearJump 0.7s cubic-bezier(.6,0,.4,1) 1;}
        @keyframes bearJump {
            0% { transform: translateY(0);}
            30% { transform: translateY(-18px);}
            60% { transform: translateY(-8px);}
            100% { transform: translateY(0);}
        }
        @media (max-width:600px) {
            .kawaii-bear { width: 28px; height: 28px; }
        }
        /* Kawaii Small Bird (bottom walker) */
        .kawaii-bird {
            position: fixed;
            z-index: 5;
            width: 32px;
            height: 32px;
            left: 0vw;
            bottom: 7vh;
            pointer-events: auto;
            opacity: 1;
            background: none;
            will-change: left, bottom;
        }
        .kawaii-bird .bird-svg {
            width: 100%; height: 100%;
            display: block;
            pointer-events: none;
            filter: drop-shadow(0 2px 6px #b3e0ff33);
        }
        .kawaii-bird .bird-shadow {
            position: absolute;
            left: 6px; right: 6px; bottom: -5px;
            height: 7px;
            border-radius: 50%;
            background: #b6e2a1;
            opacity: 0.5;
            z-index: -1;
        }
        .kawaii-bird.walk .bird-leg-left { transform: rotate(-18deg) translateY(2px);}
        .kawaii-bird.walk .bird-leg-right { transform: rotate(18deg) translateY(2px);}
        .kawaii-bird.idle .bird-leg-left,
        .kawaii-bird.idle .bird-leg-right { transform: rotate(0deg);}
        .kawaii-bird.flap .bird-wing { animation: birdFlap2 0.5s alternate infinite;}
        .kawaii-bird.jump { animation: birdJump 0.5s cubic-bezier(.6,0,.4,1) 1;}
        @keyframes birdJump {
            0% { transform: translateY(0);}
            30% { transform: translateY(-14px);}
            60% { transform: translateY(-6px);}
            100% { transform: translateY(0);}
        }
        @keyframes birdFlap2 {
            0% { transform: rotate(0deg);}
            100% { transform: rotate(-30deg);}
        }
        @media (max-width:600px) {
            .kawaii-bird { width: 20px; height: 20px; }
        }
        /* Treasure Box */
        .treasure-box-wrap {
            position: fixed;
            left: 50%;
            bottom: 2vh;
            transform: translateX(-50%);
            z-index: 20;
            display: flex;
            flex-direction: column;
            align-items: center;
            pointer-events: none;
        }
        .treasure-btn {
            pointer-events: auto;
            background: var(--pastel-yellow);
            color: #e75480;
            border: none;
            border-radius: 999px;
            padding: 8px 22px;
            font-size: 1.1rem;
            font-weight: 700;
            margin-bottom: 2px;
            box-shadow: var(--soft-shadow);
            cursor: pointer;
            transition: background .3s, color .3s, transform .3s;
        }
        .treasure-btn:active {
            background: #ffe066;
            color: #b36fae;
            transform: scale(1.07);
        }
        .treasure-box {
            position: relative;
            width: 54px; height: 44px;
            margin: 0 auto;
            pointer-events: auto;
            user-select: none;
        }
        .treasure-lid {
            position: absolute;
            width: 54px; height: 18px;
            left: 0; top: 0;
            background: linear-gradient(90deg,#ffd700 60%,#fff9c4 100%);
            border-radius: 12px 12px 8px 8px;
            border: 2px solid #ffd6ec;
            z-index: 2;
            transition: transform 0.5s cubic-bezier(.77,0,.18,1);
            box-shadow: 0 2px 8px #ffd70044;
        }
        .treasure-box.open .treasure-lid {
            transform: translateY(-24px) rotate(-18deg) scaleX(1.08);
            box-shadow: 0 8px 24px #ffd70088;
        }
        .treasure-body {
            position: absolute;
            width: 54px; height: 28px;
            left: 0; top: 16px;
            background: linear-gradient(90deg,#fff9c4 60%,#ffd700 100%);
            border-radius: 0 0 14px 14px;
            border: 2px solid #ffd6ec;
            z-index: 1;
            box-shadow: 0 2px 12px #ffd70033;
        }
        .treasure-gold {
            position: absolute;
            left: 10px; top: 22px;
            width: 34px; height: 14px;
            background: radial-gradient(circle at 50% 60%, #ffe066 60%, #ffd700 100%);
            border-radius: 8px 8px 10px 10px;
            opacity: 0;
            z-index: 3;
            pointer-events: none;
            transition: opacity 0.3s;
        }
        .treasure-box.open .treasure-gold {
            opacity: 1;
            animation: goldGlow 0.7s;
        }
        @keyframes goldGlow {
            0% { filter: brightness(1.2) blur(2px);}
            100% { filter: brightness(1.0) blur(0);}
        }
        .treasure-coins {
            position: absolute;
            left: 50%; top: 18px;
            width: 40px; height: 24px;
            pointer-events: none;
            z-index: 4;
        }
        .treasure-sparkle {
            position: absolute;
            left: 50%; top: 10px;
            width: 44px; height: 32px;
            pointer-events: none;
            z-index: 5;
        }
        /* Bear CSS Animation (no JS movement) */
        .bear-css {
            position: fixed;
            z-index: 5;
            width: 44px;
            height: 44px;
            bottom: 1.5vh;
            left: 0;
            animation: bearWalkX 14s linear infinite;
            will-change: transform;
        }
        @keyframes bearWalkX {
            0% {
                transform: translateX(-50vw) scaleX(1);
            }
            45% {
                transform: translateX(100vw) scaleX(1);
            }
            50% {
                transform: translateX(100vw) scaleX(-1);
            }
            95% {
                transform: translateX(-50vw) scaleX(-1);
            }
            100% {
                transform: translateX(-50vw) scaleX(1);
            }
        }
        .bear-css .bear-svg {
            width: 100%; height: 100%;
            display: block;
            pointer-events: none;
            filter: drop-shadow(0 2px 6px #bfa97a33);
            animation: bearLegs 0.7s steps(2) infinite;
        }
        @keyframes bearLegs {
            0% { filter: drop-shadow(0 2px 6px #bfa97a33);}
            50% { filter: drop-shadow(0 4px 8px #bfa97a33);}
            100% { filter: drop-shadow(0 2px 6px #bfa97a33);}
        }
        .bear-shadow {
            position: absolute;
            left: 8px; right: 8px; bottom: -6px;
            height: 8px;
            border-radius: 50%;
            background: #b6e2a1;
            opacity: 0.5;
            z-index: -1;
        }
        @media (max-width:600px) {
            .bear-css { width: 28px; height: 28px; }
        }

        /* Bird CSS Animation (no JS movement) */
        .bird-css {
            position: fixed;
            z-index: 5;
            width: 32px;
            height: 32px;
            bottom: 7vh;
            left: 0;
            animation: birdWalkX 11s linear infinite;
            will-change: transform;
        }
        @keyframes birdWalkX {
            0% {
                transform: translateX(110vw) scaleX(-1);
            }
            45% {
                transform: translateX(-30vw) scaleX(-1);
            }
            50% {
                transform: translateX(-30vw) scaleX(1);
            }
            95% {
                transform: translateX(110vw) scaleX(1);
            }
            100% {
                transform: translateX(110vw) scaleX(-1);
            }
        }
        .bird-css .bird-svg {
            width: 100%; height: 100%;
            display: block;
            pointer-events: none;
            filter: drop-shadow(0 2px 6px #b3e0ff33);
            animation: birdLegs 0.5s steps(2) infinite;
        }
        @keyframes birdLegs {
            0% { filter: drop-shadow(0 2px 6px #b3e0ff33);}
            50% { filter: drop-shadow(0 4px 8px #b3e0ff33);}
            100% { filter: drop-shadow(0 2px 6px #b3e0ff33);}
        }
        .bird-shadow {
            position: absolute;
            left: 6px; right: 6px; bottom: -5px;
            height: 7px;
            border-radius: 50%;
            background: #b6e2a1;
            opacity: 0.5;
            z-index: -1;
        }
        @media (max-width:600px) {
            .bird-css { width: 20px; height: 20px; }
        }
        /* ...existing code... */
    </style>
</head>
<body>
    <!-- Opening Animation -->
    <div class="opening-anim" id="openingAnim">
        <div class="opening-text">Happy Birthday Alya ITB ðŸ’™ðŸŽ‚</div>
    </div>
    <!-- Cute Background Elements -->
    <div class="bg-cloud" style="left:10vw;top:8vh;"></div>
    <div class="bg-cloud c2"></div>
    <div class="bg-cloud c3"></div>
    <div class="bg-cloud c4"></div>
    <div class="bg-star" style="left:40vw;top:5vh;"></div>
    <div class="bg-star s2"></div>
    <div class="bg-star s3"></div>
    <div class="bg-star s4"></div>
    <div class="bg-bubble" style="left:10vw;top:90vh;"></div>
    <div class="bg-bubble b2"></div>
    <div class="bg-bubble b3"></div>
    <div class="balloon"></div>
    <div class="balloon b2"></div>
    <div class="balloon b3"></div>
    <!-- Flying Birds (cute, animated, under clouds) -->
    <div class="flying-bird" id="bird1"></div>
    <div class="flying-bird" id="bird2"></div>
    <div class="flying-bird" id="bird3"></div>
    <!-- Walking Bear (cute, animated, on grass) -->
    <div class="walking-bear bear-css" id="bear1">
      <div class="bear-shadow"></div>
      <svg class="bear-svg" viewBox="0 0 44 44">
        <ellipse class="bear-body" cx="22" cy="28" rx="14" ry="12" fill="#bfa97a"/>
        <ellipse class="bear-ear-left" cx="10" cy="14" rx="5" ry="5" fill="#bfa97a"/>
        <ellipse class="bear-ear-right" cx="34" cy="14" rx="5" ry="5" fill="#bfa97a"/>
        <ellipse class="bear-face" cx="22" cy="28" rx="10" ry="8" fill="#fff"/>
        <ellipse class="bear-eye-left" cx="18" cy="28" rx="1.2" ry="1.2" fill="#3a5ca8"/>
        <ellipse class="bear-eye-right" cx="26" cy="28" rx="1.2" ry="1.2" fill="#3a5ca8"/>
        <ellipse class="bear-nose" cx="22" cy="31" rx="1.6" ry="0.7" fill="#e75480"/>
        <ellipse class="bear-leg-left" cx="15" cy="38" rx="2" ry="3" fill="#bfa97a"/>
        <ellipse class="bear-leg-right" cx="29" cy="38" rx="2" ry="3" fill="#bfa97a"/>
        <ellipse class="bear-arm-left" cx="10" cy="28" rx="1.6" ry="3" fill="#bfa97a"/>
        <ellipse class="bear-arm-right" cx="34" cy="28" rx="1.6" ry="3" fill="#bfa97a"/>
      </svg>
    </div>
    <!-- Kawaii Small Bird (new, cute, walking) -->
    <div class="kawaii-bird bird-css" id="kawaiiBird">
      <div class="bird-shadow"></div>
      <svg class="bird-svg" viewBox="0 0 32 32">
        <ellipse class="bird-body" cx="16" cy="18" rx="10" ry="8" fill="#b3e0ff"/>
        <ellipse class="bird-face" cx="16" cy="18" rx="7" ry="6" fill="#fff"/>
        <ellipse class="bird-eye-left" cx="13" cy="18" rx="0.8" ry="0.8" fill="#3a5ca8"/>
        <ellipse class="bird-eye-right" cx="19" cy="18" rx="0.8" ry="0.8" fill="#3a5ca8"/>
        <ellipse class="bird-beak" cx="16" cy="21" rx="1.2" ry="0.5" fill="#ffd700"/>
        <ellipse class="bird-leg-left" cx="13" cy="28" rx="0.7" ry="2" fill="#ffd6ec"/>
        <ellipse class="bird-leg-right" cx="19" cy="28" rx="0.7" ry="2" fill="#ffd6ec"/>
        <ellipse class="bird-wing" cx="23" cy="20" rx="3" ry="2" fill="#e3f6ff"/>
      </svg>
    </div>
    <!-- Treasure Box (cute, interactive) -->
    <div class="treasure-box-wrap">
      <button id="treasureBtn" class="treasure-btn">ðŸ§° Buka Harta Karun!</button>
      <div class="treasure-box" id="treasureBoxAnim">
        <div class="treasure-lid"></div>
        <div class="treasure-body"></div>
        <div class="treasure-gold"></div>
        <div class="treasure-coins"></div>
        <div class="treasure-sparkle"></div>
      </div>
    </div>
    <!-- Confetti -->
    <canvas class="confetti" id="confettiCanvas"></canvas>
    <!-- Fireworks -->
    <canvas class="fireworks-canvas" id="fireworksCanvas"></canvas>
    <!-- Theme Switcher -->
    <div class="theme-switcher" id="themeSwitcher" title="Ganti tema pastel / malam">ðŸŽ¨ Pastel</div>
    <!-- Background Switcher -->
    <div class="theme-switcher" id="bgSwitcher" style="right:16px;bottom:120px;" title="Ganti latar biru lucu">ðŸŒ¤ï¸ Latar</div>
    <!-- Floating Cloud Effect (Girly Parallax) -->
    <div class="float-cloud"></div>
    <div class="float-cloud right"></div>
    <!-- Ribbon Animation -->
    <div class="bg-ribbon"></div>
    <div class="bg-ribbon r2"></div>
    <!-- Flower Petal Falling -->
    <div class="bg-flower"></div>
    <div class="bg-flower f2"></div>
    <div class="bg-flower f3"></div>
    <header>
        <div class="main-title">Happy Birthday Alyaa 10 Februari ðŸŽ‚ðŸ’™</div>
        <div class="subtitle">Owh ini yang katanya jago desain sama mau ke itb!</div>
    </header>
    <nav>
        <a href="#countdown" class="active">Countdown</a>
        <a href="#ucapan">Ucapan</a>
        <a href="#motivasi">Motivasi</a>
        <a href="#galeri">Galeri</a>
        <a href="#cerita">Cerita Aku</a>
    </nav>
    <div class="container">
        <!-- Mascot -->
        <div class="mascot" title="Bunny mascot lucu">
            <div class="mascot-face">
                <div class="mascot-mouth"></div>
            </div>
        </div>
        <!-- Cake Animation -->
        <div class="cake" title="Kue ulang tahun">
            <div class="cake-base"></div>
            <div class="cake-top"></div>
            <div class="cake-candle"></div>
            <div class="cake-flame"></div>
        </div>
        <!-- Surprise Box -->
        <div class="surprise-box" id="surpriseBox" title="Klik untuk surprise!">
            <div class="surprise-lid"></div>
            <div class="surprise-msg">ðŸŽ Selamat Ulang Tahun Alya! Calon ITB ! ðŸ’™</div>
            <span style="font-size:2em;">ðŸŽ</span>
        </div>
        <!-- Countdown Card -->
        <div class="card cute" id="countdown">
            <div class="card-title"><span class="icon">â°</span>Countdown Ulang Tahun</div>
            <!-- UPGRADED COUNTDOWN BUBBLE -->
            <div class="countdown-cute-wrap" id="countdownCute">
                <div class="countdown-bubble" data-unit="hari">
                    <span class="cd-num" id="cdHari">0</span>
                    <span class="cd-label">Hari</span>
                </div>
                <div class="countdown-bubble" data-unit="jam">
                    <span class="cd-num" id="cdJam">0</span>
                    <span class="cd-label">Jam</span>
                </div>
                <div class="countdown-bubble" data-unit="menit">
                    <span class="cd-num" id="cdMenit">0</span>
                    <span class="cd-label">Menit</span>
                </div>
                <div class="countdown-bubble" data-unit="detik">
                    <span class="cd-num" id="cdDetik">0</span>
                    <span class="cd-label">Detik</span>
                </div>
            </div>
            <!-- fallback for old browser -->
            <div class="countdown" id="countdownText" style="display:none;">Loading...</div>
        </div>
        <!-- Ucapan Otomatis -->
        <div class="card cute" id="ucapan">
            <div class="card-title"><span class="icon">ðŸ’Œ</span>Ucapan Ulang Tahun</div>
            <div id="ucapanOtomatis">Hbd uyy! ðŸ’™âœ¨</div>
            <div class="music-toggle">
                <button id="musicToggleBtn" aria-label="Toggle music">ðŸŽ¶ Play Music</button>
                <span id="musicStatus" style="font-size:1.1em;color:#7baed6;"></span>
            </div>
            <audio id="bgMusic" loop preload="auto">
                <source src="https://cdn.pixabay.com/audio/2022/10/16/audio_12b7b2b7e2.mp3" type="audio/mp3">
            </audio>
            <form class="form-ucapan" id="formUcapan" autocomplete="off">
                <input type="text" id="namaUcapan" placeholder="Nama kamu" maxlength="18" required>
                <textarea id="isiUcapan" placeholder="Tulis ucapanmu..." maxlength="120" required></textarea>
                <button type="submit">ðŸ’Œ Kirim Ucapan</button>
            </form>
            <div class="ucapan-list" id="ucapanList"></div>
        </div>
        <!-- Motivasi / Quotes -->
        <div class="card cute" id="motivasi">
            <div class="card-title"><span class="icon">ðŸ’¬</span>Kata-kata Penyemangat</div>
            <ul class="motivasi-list" id="motivasiList">
                <li>â€œJangan takut gagal, katanya mau ke itb ðŸ’ªâ€</li>
                <li>â€œKamu lebih kuat dari yang kamu kira ðŸ’™â€</li>
                <li>â€œMimpi itu setinggi langit jangan setinggi gedung alirsat âœ¨â€</li>
                <li>â€œMasa depan bisa lebih cerah, jangan ragu melangkah ðŸŒˆâ€</li>
            </ul>
            <div style="margin-top:10px;">
                <button id="quoteGenBtn" class="fireworks-btn" style="font-size:1em;">ðŸ§  Generate Quote</button>
                <span id="quoteGenResult" style="margin-left:8px;color:#3a5ca8;font-weight:700;"></span>
            </div>
        </div>
        <!-- Galeri Foto -->
        <div class="card cute" id="galeri">
            <div class="card-title"><span class="icon">ðŸ“¸</span>Galeri Foto</div>
            <div class="gallery">
                <img src="https://placekitten.com/200/200" alt="Foto lucu 1">
                <img src="https://placebear.com/200/200" alt="Foto lucu 2">
                <img src="https://placebeard.it/200x200" alt="Foto lucu 3">
                <img src="https://placekitten.com/201/200" alt="Foto lucu 4">
            </div>
        </div>
        <!-- Fireworks Button -->
        <button class="fireworks-btn" id="fireworksBtn">ðŸŽ† Pencet Kembang Api!</button>
        <!-- Cerita Aku / My Notes -->
        <div class="card cute story-section" id="cerita">
            <div class="card-title"><span class="icon">ðŸ“–âœ¨</span>Cerita Aku</div>
            <form class="story-form" id="storyForm" autocomplete="off">
                <textarea id="storyInput" placeholder="Tulis cerita, curhat, diary, atau memo di sini..." maxlength="300"></textarea>
                <div class="story-btns">
                    <button type="submit" id="saveStoryBtn">ðŸ’¾ Simpan Cerita</button>
                    <button type="button" id="clearStoryBtn">ðŸ—‘ï¸ Hapus Semua</button>
                </div>
                <span id="saveSuccessMsg" style="display:none;" class="save-success">Cerita tersimpan! âœ¨</span>
            </form>
            <div class="story-list" id="storyList"></div>
        </div>
    </div>
    <footer>
        <p>Â© 2026 Happy Birthday Alya 10 Februari 2010ðŸŽ‚ðŸ’™ | Private & Local Only</p>
    </footer>
    <script>
    // Modular JS, clean, commented, no memory leak, debounce, smooth
    // --- Opening Animation ---
    setTimeout(() => {
        document.getElementById('openingAnim').style.display = 'none';
        triggerConfetti();
    }, 2400);

    // --- Navigation Active ---
    document.querySelectorAll('nav a').forEach(a => {
        a.addEventListener('click', function() {
            document.querySelectorAll('nav a').forEach(x => x.classList.remove('active'));
            this.classList.add('active');
        });
    });

    // --- COUNTDOWN UPGRADE: FLIP, PULSE, SPARKLE, PARTICLE, SMART DATE, AUTO RESET, CELEBRATION ---
    (function(){
        // Helper: animate flip/pulse
        function animateNum(el, type) {
            el.classList.remove('flip','pulse');
            void el.offsetWidth; // force reflow
            el.classList.add(type);
            setTimeout(()=>el.classList.remove(type), 600);
        }
        // Helper: sparkle/heart/star
        function addCountdownParticle(bubble) {
            const r = Math.random();
            let el;
            if (r < 0.33) {
                el = document.createElement('span');
                el.className = 'cd-sparkle';
                el.textContent = 'âœ¨';
            } else if (r < 0.66) {
                el = document.createElement('span');
                el.className = 'cd-heart';
                el.textContent = 'ðŸ’•';
            } else {
                el = document.createElement('span');
                el.className = 'cd-star';
                el.textContent = 'â­';
            }
            bubble.appendChild(el);
            setTimeout(()=>{el.remove();}, 900);
        }
        function glowBubble(bubble) {
            bubble.classList.add('glow');
            setTimeout(()=>bubble.classList.remove('glow'), 700);
        }

        // Celebration trigger
        let celebrationTriggered = false;
        function triggerBirthdayCelebration() {
            if (celebrationTriggered) return;
            celebrationTriggered = true;
            // Show message
            const wrap = document.getElementById('countdownCute');
            let msg = document.createElement('div');
            msg.id = 'birthdayMsg';
            msg.style.cssText = "position:absolute;left:50%;top:50%;transform:translate(-50%,-50%);background:linear-gradient(135deg,#fff9c4cc,#ffd6ecbb);padding:18px 28px;border-radius:22px;box-shadow:0 4px 24px #ffd6ec55;font-size:1.4rem;font-family:'Fredoka',cursive,sans-serif;color:#e75480;font-weight:700;z-index:10;animation:fadeInZoom 1s;";
            msg.innerHTML = "ðŸŽ‚ Happy Birthday!!! ðŸŽ‰ðŸ’™";
            wrap.appendChild(msg);
            setTimeout(()=>{if(msg)msg.remove();}, 5000);

            // Trigger confetti
            triggerConfetti();

            // Trigger fireworks
            if (typeof triggerFirstVisitFireworks === "function") {
                triggerFirstVisitFireworks();
            } else {
                // fallback: manual pastel fireworks
                (function(){
                    const canvas = document.createElement('canvas');
                    canvas.className = 'fireworks-canvas';
                    canvas.style.zIndex = 99999;
                    canvas.style.pointerEvents = 'none';
                    canvas.width = window.innerWidth;
                    canvas.height = window.innerHeight;
                    document.body.appendChild(canvas);
                    const ctx = canvas.getContext('2d');
                    let particles = [];
                    let fireworksCount = 6 + Math.floor(Math.random()*3);
                    let running = true;
                    function pastelColor() {
                        const pastel = [
                            "#b3e0ff", "#ffd6ec", "#fff9c4", "#e6e6fa", "#d0f1ff", "#b3b8f8",
                            "#e75480", "#7baed6", "#f3e8ff", "#ffd700", "#ffb6b9", "#a2d5f2"
                        ];
                        return pastel[Math.floor(Math.random() * pastel.length)];
                    }
                    function burst(x, y) {
                        let count = 32 + Math.floor(Math.random()*14);
                        let angleOffset = Math.random() * Math.PI * 2;
                        for (let i=0;i<count;i++) {
                            let angle = angleOffset + (Math.PI*2*i)/count;
                            let speed = 2.2 + Math.random()*2.8;
                            particles.push({
                                x, y,
                                vx: Math.cos(angle)*speed*(0.9+Math.random()*0.3),
                                vy: Math.sin(angle)*speed*(0.9+Math.random()*0.3),
                                alpha: 1,
                                color: pastelColor(),
                                size: 2+Math.random()*3,
                                life: 0,
                                maxLife: 32+Math.random()*18
                            });
                        }
                    }
                    for (let i=0;i<fireworksCount;i++) {
                        setTimeout(()=>{
                            let x = canvas.width*(0.12+0.76*Math.random());
                            let y = canvas.height*(0.18+0.6*Math.random());
                            burst(x, y);
                        }, i*260+Math.random()*120);
                    }
                    function draw() {
                        ctx.clearRect(0, 0, canvas.width, canvas.height);
                        particles = particles.filter(p=>p.alpha>0.05 && p.life<p.maxLife);
                        for (let p of particles) {
                            ctx.save();
                            ctx.globalAlpha = p.alpha;
                            ctx.beginPath();
                            ctx.arc(p.x, p.y, p.size, 0, Math.PI*2);
                            ctx.fillStyle = p.color;
                            ctx.shadowColor = p.color;
                            ctx.shadowBlur = 10;
                            ctx.fill();
                            ctx.shadowBlur = 0;
                            ctx.restore();
                            p.x += p.vx;
                            p.y += p.vy;
                            p.vx *= 0.96;
                            p.vy *= 0.96;
                            p.vy += 0.04;
                            p.life++;
                            p.alpha *= 0.96;
                        }
                        ctx.globalAlpha = 1;
                        if (particles.length>0 && running) {
                            requestAnimationFrame(draw);
                        }
                    }
                    draw();
                    setTimeout(()=>{
                        running = false;
                        setTimeout(()=>{canvas.remove();}, 900);
                    }, 2600);
                    window.addEventListener('resize', ()=>{
                        canvas.width = window.innerWidth;
                        canvas.height = window.innerHeight;
                    });
                })();
            }
        }

        // Smart countdown logic
        let intervalId = null;
        function getTargetDate(now) {
            // 10 Februari, jam 0:0:0
            let year = now.getFullYear();
            let target = new Date(year, 1, 10, 0, 0, 0, 0);
            if (now.getTime() > target.getTime()) {
                // Sudah lewat, target tahun depan
                target = new Date(year + 1, 1, 10, 0, 0, 0, 0);
            }
            return target;
        }
        function updateCountdownCute() {
            const now = new Date();
            const target = getTargetDate(now);
            let diff = target - now;
            if (diff < 0) diff = 0;
            let d = Math.floor(diff / (1000 * 60 * 60 * 24));
            let h = Math.floor((diff / (1000 * 60 * 60)) % 24);
            let m = Math.floor((diff / (1000 * 60)) % 60);
            let s = Math.floor((diff / 1000) % 60);

            // Anti NaN
            if (isNaN(d) || isNaN(h) || isNaN(m) || isNaN(s)) {
                d = h = m = s = 0;
            }

            const hariEl = document.getElementById('cdHari');
            const jamEl = document.getElementById('cdJam');
            const menitEl = document.getElementById('cdMenit');
            const detikEl = document.getElementById('cdDetik');
            const fallback = document.getElementById('countdownText');
            const wrap = document.getElementById('countdownCute');

            // If countdown finished
            if (diff <= 0) {
                hariEl.textContent = jamEl.textContent = menitEl.textContent = detikEl.textContent = "0";
                fallback.style.display = "none";
                // Show message & celebration
                triggerBirthdayCelebration();
                // Stop interval, auto reset after 10 Feb next year
                if (intervalId) clearInterval(intervalId);
                // Set timeout to reset countdown after 1 minute (or check every 10s)
                setTimeout(function checkReset() {
                    const now2 = new Date();
                    const nextTarget = getTargetDate(now2);
                    if (nextTarget - now2 > 0) {
                        celebrationTriggered = false;
                        if (document.getElementById('birthdayMsg')) document.getElementById('birthdayMsg').remove();
                        intervalId = setInterval(updateCountdownCute, 1000);
                        updateCountdownCute();
                    } else {
                        setTimeout(checkReset, 10000);
                    }
                }, 10000);
                return;
            }

            // Update each bubble with animation
            if (hariEl.textContent != d) {
                hariEl.textContent = d;
                animateNum(hariEl, 'flip');
                glowBubble(hariEl.parentElement);
                addCountdownParticle(hariEl.parentElement);
            }
            if (jamEl.textContent != h) {
                jamEl.textContent = h;
                animateNum(jamEl, 'flip');
                glowBubble(jamEl.parentElement);
                addCountdownParticle(jamEl.parentElement);
            }
            if (menitEl.textContent != m) {
                menitEl.textContent = m;
                animateNum(menitEl, 'flip');
                glowBubble(menitEl.parentElement);
                addCountdownParticle(menitEl.parentElement);
            }
            if (detikEl.textContent != s) {
                detikEl.textContent = s;
                animateNum(detikEl, 'pulse');
                glowBubble(detikEl.parentElement);
                addCountdownParticle(detikEl.parentElement);
            }
            fallback.style.display = 'none';
        }
        // Clean interval if exists
        if (window._countdownIntervalId) clearInterval(window._countdownIntervalId);
        intervalId = setInterval(updateCountdownCute, 1000);
        window._countdownIntervalId = intervalId;
        updateCountdownCute();

        // Expose for celebration fallback
        window.triggerFirstVisitFireworks = window.triggerFirstVisitFireworks || null;
    })();

    // --- Ucapan Otomatis ---
    const ucapanArr = [
        "Selamat ulang tahun! Semoga hari-harimu selalu ceria dan penuh cinta ðŸ’™âœ¨",
        "Happy birthday! Semoga semua impianmu tercapai ðŸŽ‚ðŸ’™",
        "Semoga selalu sehat, bahagia, dan sukses! ðŸŽ‰",
        "Hari ini spesial, sama seperti kamu! ðŸ’™",
        "Semoga tahun ini penuh kebahagiaan dan kejutan indah! âœ¨"
    ];
    function randomUcapan() {
        return ucapanArr[Math.floor(Math.random() * ucapanArr.length)];
    }
    setInterval(() => {
        document.getElementById('ucapanOtomatis').textContent = randomUcapan();
    }, 6000);

    // --- Music Toggle ---
    const musicBtn = document.getElementById('musicToggleBtn');
    const music = document.getElementById('bgMusic');
    const musicStatus = document.getElementById('musicStatus');
    let musicPlaying = false;
    musicBtn.addEventListener('click', () => {
        if (!musicPlaying) {
            music.play().then(()=>{}).catch(()=>{});
            musicPlaying = true;
            musicBtn.textContent = "ðŸŽ¶ Pause Music";
            musicBtn.classList.add('active');
            musicStatus.textContent = "Playing...";
        } else {
            music.pause();
            musicPlaying = false;
            musicBtn.textContent = "ðŸŽ¶ Play Music";
            musicBtn.classList.remove('active');
            musicStatus.textContent = "Paused";
        }
    });
    music.addEventListener('ended', () => {
        musicPlaying = false;
        musicBtn.textContent = "ðŸŽ¶ Play Music";
        musicBtn.classList.remove('active');
        musicStatus.textContent = "Paused";
    });

    // --- Form Ucapan Pengunjung ---
    const formUcapan = document.getElementById('formUcapan');
    const ucapanList = document.getElementById('ucapanList');
    let ucapanData = JSON.parse(localStorage.getItem('ucapanData') || '[]');
    function renderUcapan() {
        ucapanList.innerHTML = '';
        ucapanData.slice().reverse().forEach(u => {
            const div = document.createElement('div');
            div.className = 'ucapan-item';
            div.innerHTML = `<div class="ucapan-nama">${u.nama}</div>
                <div>${u.isi}</div>
                <div class="ucapan-tgl">${u.tgl}</div>`;
            ucapanList.appendChild(div);
        });
    }
    renderUcapan();
    formUcapan.addEventListener('submit', function(e) {
        e.preventDefault();
        const nama = document.getElementById('namaUcapan').value.trim() || "Anonim";
        const isi = document.getElementById('isiUcapan').value.trim();
        if (!isi) return;
        const tgl = new Date().toLocaleString('id-ID', { dateStyle: 'short', timeStyle: 'short' });
        ucapanData.push({ nama, isi, tgl });
        localStorage.setItem('ucapanData', JSON.stringify(ucapanData));
        renderUcapan();
        formUcapan.reset();
    });

    // --- Motivasi / Quotes Generator ---
    const motivasiArr = [
        "Jangan menyerah, katanya mau ke itb ðŸ’ª",
        "Setiap hari adalah kesempatan baru! âœ¨",
        "jangan bolos jam edu mulu! ðŸŒˆ",
        "Owh ini yg bagus di desainnya ! ðŸ˜Š",
        "Hidup itu indah, nikmati setiap momennya! ðŸ’™",
        "Percaya pada dirimu sendiri, lu hebat! ðŸ¦„",
        "Jangan takut gagal, karena setiap gagal itu satu langkah menuju sukses ke itb ðŸ’ª",
        "Kamu lebih kuat dari yang kamu kira ðŸ’™",
        "Tetap jadi versi terbaik dari diri lu sendiri âœ¨",
        "bagaikan rembulan bulan di malam hari ðŸŒˆ"
    ];
    const quoteGenBtn = document.getElementById('quoteGenBtn');
    const quoteGenResult = document.getElementById('quoteGenResult');
    quoteGenBtn.addEventListener('click', debounce(function() {
        quoteGenResult.textContent = motivasiArr[Math.floor(Math.random() * motivasiArr.length)];
        setTimeout(()=>{quoteGenResult.textContent='';}, 4000);
    }, 400));

    // --- Fireworks (Canvas, optimized, no lag, no leak) ---
    const fireworksBtn = document.getElementById('fireworksBtn');
    const fireworksCanvas = document.getElementById('fireworksCanvas');
    let fwCtx = fireworksCanvas.getContext('2d');
    let fireworksParticles = [];
    let fireworksActive = false;

    // Tambah efek flash
    function flashScreen() {
        const flash = document.createElement('div');
        flash.style.position = 'fixed';
        flash.style.left = '0';
        flash.style.top = '0';
        flash.style.width = '100vw';

        flash.style.height = '100vh';
        flash.style.background = 'rgba(255,255,255,0.25)';
        flash.style.zIndex = '99999';
        flash.style.pointerEvents = 'none';
        flash.style.transition = 'opacity 0.5s';
        document.body.appendChild(flash);
        setTimeout(() => { flash.style.opacity = '0'; }, 120);
        setTimeout(() => { flash.remove(); }, 600);
    }

    function resizeFireworksCanvas() {
        fireworksCanvas.width = window.innerWidth;
        fireworksCanvas.height = window.innerHeight;
    }
    window.addEventListener('resize', resizeFireworksCanvas);
    resizeFireworksCanvas();

    // Tambah warna lebih banyak
    function randomColor() {
        const pastel = [
            "#b3e0ff", "#ffd6ec", "#fff9c4", "#e6e6fa", "#d0f1ff", "#b3b8f8",
            "#e75480", "#7baed6", "#f3e8ff", "#ffd700", "#ffb6b9", "#a2d5f2"
        ];
        return pastel[Math.floor(Math.random() * pastel.length)];
    }

    // Tambah suara kembang api (opsional)
    function playFireworkSound() {
        const audio = new Audio("https://cdn.pixabay.com/audio/2022/03/15/audio_115b7b2e7b.mp3");
        audio.volume = 0.3;
        audio.play();
    }

    // Ledakan lebih meriah: lebih banyak partikel dan ledakan beruntun
    function launchFirework(x, y, burst = 1) {
        for (let b = 0; b < burst; b++) {
            const count = 48 + Math.floor(Math.random() * 32); // lebih banyak partikel
            const angleOffset = Math.random() * Math.PI * 2;
            for (let i = 0; i < count; i++) {
                const angle = angleOffset + (Math.PI * 2 * i) / count;
                const speed = 2.5 + Math.random() * 3.5;
                fireworksParticles.push({
                    x, y,
                    vx: Math.cos(angle) * speed * (0.9 + Math.random()*0.3),
                    vy: Math.sin(angle) * speed * (0.9 + Math.random()*0.3),
                    alpha: 1,
                    color: randomColor(),
                    size: 2 + Math.random() * 4, // lebih besar
                    life: 0,
                    maxLife: 38 + Math.random() * 22
                });
            }
        }
        flashScreen();
        playFireworkSound();
    }

    function renderFireworks() {
        fwCtx.clearRect(0, 0, fireworksCanvas.width, fireworksCanvas.height);
        fireworksParticles = fireworksParticles.filter(p => p.alpha > 0.05 && p.life < p.maxLife);
        for (let p of fireworksParticles) {
            fwCtx.globalAlpha = p.alpha;
            fwCtx.beginPath();
            fwCtx.arc(p.x, p.y, p.size, 0, Math.PI * 2);
            fwCtx.fillStyle = p.color;
            fwCtx.shadowColor = p.color;
            fwCtx.shadowBlur = 12;
            fwCtx.fill();
            fwCtx.shadowBlur = 0;
            fwCtx.restore();
            p.x += p.vx;
            p.y += p.vy;
            p.vx *= 0.96;
            p.vy *= 0.96;
            p.vy += 0.04; // gravity lebih kuat
            p.life++;
            p.alpha *= 0.96;
        }
        fwCtx.globalAlpha = 1;
        if (fireworksParticles.length > 0 && fireworksActive) {
            requestAnimationFrame(renderFireworks);
        } else {
            fireworksActive = false;
            fireworksParticles = [];
            fwCtx.clearRect(0, 0, fireworksCanvas.width, fireworksCanvas.height);
        }
    }

    // Ledakan beruntun dan cascade
    fireworksBtn.addEventListener('click', debounce(function() {
        if (fireworksActive) return;
        fireworksActive = true;
        let totalBursts = 7; // lebih banyak ledakan
        for (let i = 0; i < totalBursts; i++) {
            setTimeout(() => {
                const burstCount = 1 + Math.floor(Math.random()*2); // kadang double burst
                for (let b = 0; b < burstCount; b++) {
                    launchFirework(
                        window.innerWidth * (0.15 + 0.7 * Math.random()),
                        window.innerHeight * (0.18 + 0.7 * Math.random()),
                        1 + Math.floor(Math.random()*2) // kadang burst ganda
                    );
                }
                if (!fireworksActive) return;
                renderFireworks();
            }, i * 260 + Math.random()*120);
        }
        setTimeout(() => { fireworksActive = false; }, 260 * totalBursts + 1200);
    }, 700));

    // --- Confetti (on load, lightweight) ---
    function triggerConfetti() {
        const canvas = document.getElementById('confettiCanvas');
        const ctx = canvas.getContext('2d');
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;
        let confettiArr = [];
        for (let i = 0; i < 36; i++) {
            confettiArr.push({
                x: Math.random() * canvas.width,
                y: -20 - Math.random() * 80,
                r: 8 + Math.random() * 8,
                c: randomColor(),
                vy: 2 + Math.random() * 2,
                vx: -1 + Math.random() * 2,
                a: Math.random() * Math.PI * 2
            });
        }
        let frame = 0;
        function drawConfetti() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            confettiArr.forEach(cf => {
                ctx.save();
                ctx.translate(cf.x, cf.y);
                ctx.rotate(cf.a + frame * 0.03);
                ctx.fillStyle = cf.c;
                ctx.beginPath();
                ctx.arc(0, 0, cf.r, 0, Math.PI * 2);
                ctx.fill();
                ctx.restore();
                cf.x += cf.vx;
                cf.y += cf.vy;
            });
            frame++;
            confettiArr = confettiArr.filter(cf => cf.y < canvas.height + 30);
            if (confettiArr.length > 0) {
                requestAnimationFrame(drawConfetti);
            } else {
                ctx.clearRect(0, 0, canvas.width, canvas.height);
            }
        }
        drawConfetti();
    }

    // --- Surprise Box ---
    const surpriseBox = document.getElementById('surpriseBox');
    surpriseBox.addEventListener('click', debounce(function() {
        surpriseBox.classList.toggle('open');
        setTimeout(() => {
            surpriseBox.classList.remove('open');
        }, 2200);
    }, 700));

    // --- Cerita Aku / My Notes (LocalStorage, edit, hapus, animasi save) ---

    const storyForm = document.getElementById('storyForm');
    const storyInput = document.getElementById('storyInput');
    const storyList = document.getElementById('storyList');
    const saveSuccessMsg = document.getElementById('saveSuccessMsg');
    const clearStoryBtn = document.getElementById('clearStoryBtn');
    let storyData = JSON.parse(localStorage.getItem('storyData') || '[]');
    let editingStoryIdx = null;
    function renderStory() {
        storyList.innerHTML = '';
        storyData.slice().reverse().forEach((s, idx) => {
            const div = document.createElement('div');
            div.className = 'story-card';
            div.innerHTML = `
                <div>${s.text}</div>
                <div class="story-date">${s.date}</div>
                <div class="story-actions">
                    <button title="Edit" onclick="editStory(${storyData.length-1-idx})">ðŸ“</button>
                    <button title="Hapus" onclick="deleteStory(${storyData.length-1-idx})">ðŸ—‘ï¸</button>
                </div>
            `;
            storyList.appendChild(div);
        });
    }
    window.editStory = function(idx) {
        editingStoryIdx = idx;
        storyInput.value = storyData[idx].text;
        storyInput.focus();
        storyInput.scrollIntoView({behavior:'smooth'});
    }
    window.deleteStory = function(idx) {
        if (confirm('Hapus cerita ini?')) {
            storyData.splice(idx, 1);
            localStorage.setItem('storyData', JSON.stringify(storyData));
            renderStory();
        }
    }
    storyForm.addEventListener('submit', function(e) {
        e.preventDefault();
        const text = storyInput.value.trim();
        if (!text) return;
        const date = new Date().toLocaleString('id-ID', { dateStyle: 'short', timeStyle: 'short' });
        if (editingStoryIdx !== null) {
            storyData[editingStoryIdx].text = text;
            storyData[editingStoryIdx].date = date;
            editingStoryIdx = null;
        } else {
            storyData.push({ text, date });
        }
        localStorage.setItem('storyData', JSON.stringify(storyData));
        renderStory();
        storyForm.reset();
        saveSuccessMsg.style.display = 'inline-block';
        setTimeout(()=>{saveSuccessMsg.style.display='none';}, 1200);
    });
    clearStoryBtn.addEventListener('click', function() {
        if (confirm('Hapus semua cerita?')) {
            storyData = [];
            localStorage.setItem('storyData', '[]');
            renderStory();
        }
    });
    renderStory();

    // --- Theme Switcher (Pastel/Night) ---
    const themeSwitcher = document.getElementById('themeSwitcher');
    let nightMode = false;
    themeSwitcher.addEventListener('click', function() {
        nightMode = !nightMode;
        document.body.classList.toggle('night', nightMode);
        themeSwitcher.classList.toggle('night', nightMode);
        themeSwitcher.textContent = nightMode ? "ðŸŒ™ Night" : "ðŸŽ¨ Pastel";
    });

    // --- Background Switcher (Blue, Cloud, Star, Bubble, Soft Sky) ---
    const bgSwitcher = document.getElementById('bgSwitcher');
    // Daftar latar: gradient, cloud, star, bubble, soft sky
    const bgModes = [
        {
            name: "ðŸŒ¤ï¸ Gradient",
            bodyBg: "linear-gradient(135deg, #b3e0ff 0%, #e3f6ff 100%)",
            showCloud: true,
            showStar: true,
            showBubble: true
        },
        {
            name: "â˜ï¸ Cloud",
            bodyBg: "linear-gradient(120deg, #b3e0ff 0%, #d0f1ff 100%)",
            showCloud: true,
            showStar: false,
            showBubble: false
        },
        {
            name: "â­ Star",
            bodyBg: "linear-gradient(135deg, #b3e0ff 0%, #e6e6fa 100%)",
            showCloud: false,
            showStar: true,
            showBubble: false
        },
        {
            name: "ðŸ«§ Bubble",
            bodyBg: "linear-gradient(135deg, #b3e0ff 0%, #d0f1ff 100%)",
            showCloud: false,
            showStar: false,
            showBubble: true
        },
        {
            name: "ðŸŒˆ Soft Sky",
            bodyBg: "linear-gradient(135deg, #b3e0ff 0%, #ffd6ec 100%)",
            showCloud: true,
            showStar: true,
            showBubble: true
        }
    ];
    let bgIdx = 0;
    function applyBgMode(idx) {
        const mode = bgModes[idx];
        document.body.style.background = mode.bodyBg;
        // Tampilkan/sembunyikan elemen background
        document.querySelectorAll('.bg-cloud').forEach(e => e.style.display = mode.showCloud ? '' : 'none');
        document.querySelectorAll('.bg-star').forEach(e => e.style.display = mode.showStar ? '' : 'none');
        document.querySelectorAll('.bg-bubble').forEach(e => e.style.display = mode.showBubble ? '' : 'none');
        bgSwitcher.textContent = mode.name + " Latar";
    }
    bgSwitcher.addEventListener('click', function() {
        bgIdx = (bgIdx + 1) % bgModes.length;
        applyBgMode(bgIdx);
    });
    // Inisialisasi latar default
    applyBgMode(bgIdx);

    // --- Sparkle Effect on Click ---
    document.body.addEventListener('click', function(e) {
        if (e.target.closest('button, a, input, textarea, .surprise-box')) return;
        createSparkle(e.clientX, e.clientY);
        createClickEffect(e.clientX, e.clientY);
    });
    function createSparkle(x, y) {
        const s = document.createElement('div');
        s.className = 'sparkle';
        s.style.left = (x-9) + 'px';
        s.style.top = (y-9) + 'px';
        document.body.appendChild(s);
        setTimeout(()=>{s.remove();}, 700);
    }
    function createClickEffect(x, y) {
        const el = document.createElement('div');
        el.className = 'click-effect';
        el.style.left = (x-12) + 'px';
        el.style.top = (y-12) + 'px';
        el.textContent = Math.random() > 0.5 ? 'â­' : 'ðŸ’•';
        document.body.appendChild(el);
        setTimeout(()=>{el.remove();}, 700);
    }

    // --- Utility: Mondar-mandir hewan lucu ---
    function animateAnimal(animal, options) {
        let screenW = window.innerWidth;
        let bottom = options.bottom || 0;
        let topMin = options.topMin || 0, topMax = options.topMax || 0;
        let leftStart, leftEnd, flip;
        // Always start from left to right, then reverse after finish
        let direction = animal._direction || 1; // 1: L->R, -1: R->L
        if (direction === 1) {
            leftStart = options.leftStart !== undefined ? options.leftStart : -60;
            leftEnd = options.leftEnd !== undefined ? options.leftEnd : screenW + 60;
            flip = 1;
        } else {
            leftStart = options.leftEnd !== undefined ? options.leftEnd : screenW + 60;
            leftEnd = options.leftStart !== undefined ? options.leftStart : -60;
            flip = -1;
        }
        let duration = options.duration || (7000 + Math.random() * 3500);
        let amplitude = options.amplitude || 7;
        let freq = options.freq || 2;
        let verticalBase = options.verticalBase || bottom;
        let verticalType = options.verticalType || 'bottom';

        // Untuk burung, gunakan top, untuk darat gunakan bottom
        if (verticalType === 'top') {
            let top = topMin + Math.random() * (topMax - topMin);
            animal.style.top = top + 'px';
            animal.style.bottom = '';
        } else {
            animal.style.bottom = verticalBase + 'px';
            animal.style.top = '';
        }
        animal.style.left = leftStart + 'px';
        animal.style.transform = `scaleX(${flip})`;
        animal.style.opacity = 0.98;

        let start = null;
        let stepState = 0;
        let pauseAt = Math.random() * 0.5 + 0.25;
        let paused = false;
        let pauseDuration = 700 + Math.random()*700;

        function move(ts) {
            if (!start) start = ts;
            let t = ts - start;
            let progress = t / duration;
            if (progress > 1) {
                // Reverse direction for next run
                animal._direction = (animal._direction === 1 ? -1 : 1);
                setTimeout(() => animateAnimal(animal, options), 400 + Math.random()*600);
                animal.style.opacity = 0;
                animal.classList.remove('lift-left','lift-right');
                return;
            }
            // Pause lucu di tengah jalan
            if (!paused && progress > pauseAt && progress < pauseAt+0.08) {
                paused = true;
                setTimeout(() => {
                    paused = false;
                    start += pauseDuration;
                }, pauseDuration);
            }
            if (paused) {
                requestAnimationFrame(move);
                return;
            }
            let x = leftStart + (leftEnd - leftStart) * progress;
            let y = verticalBase + Math.sin(progress * Math.PI * freq) * amplitude;
            animal.style.left = x + 'px';
            if (verticalType === 'top') {
                animal.style.top = y + 'px';
            } else {
                animal.style.bottom = y + 'px';
            }
            stepState = (stepState+1)%2;
            animal.classList.toggle('lift-left', stepState===0);
            animal.classList.toggle('lift-right', stepState===1);
            requestAnimationFrame(move);
        }
        setTimeout(() => {
            animal.style.opacity = 0.98;
            requestAnimationFrame(move);
        }, 400 + Math.random()*600);
    }

    // --- Flying Birds Animation (mondar-mandir lucu) ---
    ['bird1','bird2','bird3'].forEach((id,i) => {
        const bird = document.getElementById(id);
        bird._direction = 1;
        animateAnimal(bird, {
            topMin: window.innerHeight * 0.13,
            topMax: window.innerHeight * 0.22,
            leftStart: -40,
            leftEnd: window.innerWidth + 40,
            duration: 7000 + Math.random() * 3500,
            amplitude: 16 + Math.random() * 18,
            freq: 1.2 + Math.random() * 0.7,
            verticalType: 'top'
        });
    });
    window.addEventListener('resize', debounce(function() {
        ['bird1','bird2','bird3'].forEach((id,i) => {
            const bird = document.getElementById(id);
            bird._direction = 1;
            animateAnimal(bird, {
                topMin: window.innerHeight * 0.13,
                topMax: window.innerHeight * 0.22,
                leftStart: -40,
                leftEnd: window.innerWidth + 40,
                duration: 7000 + Math.random() * 3500,
                amplitude: 16 + Math.random() * 18,
                freq: 1.2 + Math.random() * 0.7,
                verticalType: 'top'
            });
        });
    }, 400));

    // --- Walking Bear Animation (mondar-mandir lucu) ---
    animateAnimal(document.getElementById('bear1'), {
        bottom: window.innerHeight * 0.04,
        leftStart: -60,
        leftEnd: window.innerWidth + 60,
        duration: 9000 + Math.random() * 3500,
        amplitude: 7,
        freq: 2,
        verticalBase: window.innerHeight * 0.04,
        verticalType: 'bottom'
    });
    window.addEventListener('resize', debounce(function() {
        animateAnimal(document.getElementById('bear1'), {
            bottom: window.innerHeight * 0.04,
            leftStart: -60,
            leftEnd: window.innerWidth + 60,
            duration: 9000 + Math.random() * 3500,
            amplitude: 7,
            freq: 2,
            verticalBase: window.innerHeight * 0.04,
            verticalType: 'bottom'
        });
    }, 400));

    // --- Walking Bunny Mascot Animation (mondar-mandir lucu) ---
    animateAnimal(document.getElementById('bunny1'), {
        bottom: window.innerHeight * 0.10,
        leftStart: -50,
        leftEnd: window.innerWidth + 50,
        duration: 8500 + Math.random() * 3500,
        amplitude: 8,
        freq: 2.2,
        verticalBase: window.innerHeight * 0.10,
        verticalType: 'bottom'
    });
    window.addEventListener('resize', debounce(function() {
        animateAnimal(document.getElementById('bunny1'), {
            bottom: window.innerHeight * 0.10,
            leftStart: -50,
            leftEnd: window.innerWidth + 50,
            duration: 8500 + Math.random() * 3500,
            amplitude: 8,
            freq: 2.2,
            verticalBase: window.innerHeight * 0.10,
            verticalType: 'bottom'
        });
    }, 400));

    // --- Kawaii Bear Animation ---
    (function(){
        const bear = document.getElementById('kawaiiBear');
        bear.innerHTML = `
        <div class="bear-shadow"></div>
        <svg class="bear-svg" viewBox="0 0 44 44">
            <ellipse class="bear-body" cx="22" cy="28" rx="14" ry="12" fill="#bfa97a"/>
            <ellipse class="bear-ear-left" cx="10" cy="14" rx="5" ry="5" fill="#bfa97a"/>
            <ellipse class="bear-ear-right" cx="34" cy="14" rx="5" ry="5" fill="#bfa97a"/>
            <ellipse class="bear-face" cx="22" cy="28" rx="10" ry="8" fill="#fff"/>
            <ellipse class="bear-eye-left" cx="18" cy="28" rx="1.2" ry="1.2" fill="#3a5ca8"/>
            <ellipse class="bear-eye-right" cx="26" cy="28" rx="1.2" ry="1.2" fill="#3a5ca8"/>
            <ellipse class="bear-nose" cx="22" cy="31" rx="1.6" ry="0.7" fill="#e75480"/>
            <ellipse class="bear-leg-left" cx="15" cy="38" rx="2" ry="3" fill="#bfa97a"/>
            <ellipse class="bear-leg-right" cx="29" cy="38" rx="2" ry="3" fill="#bfa97a"/>
            <ellipse class="bear-arm-left" cx="10" cy="28" rx="1.6" ry="3" fill="#bfa97a"/>
            <ellipse class="bear-arm-right" cx="34" cy="28" rx="1.6" ry="3" fill="#bfa97a"/>
        </svg>
        <div class="love">ðŸ’•</div>
        `;
        let state = 'walk';
        let dir = 1;
        let pos = 0;
        let vw = window.innerWidth;
        let idleTimer = 0;
        let idleTimeout = 0;
        let animFrame;
        function setState(s) {
            bear.classList.remove('walk','idle','wave','sit','jump','smile','love');
            bear.classList.add(s);
            state = s;
        }
        function randomIdle() {
            const r = Math.random();
            if (r < 0.33) return 'wave';
            if (r < 0.66) return 'sit';
            return 'jump';
        }
        function walkLoop() {
            pos += dir * 1.1 * (window.innerWidth/900+0.7);
            if (pos < 0) { dir = 1; bear.style.transform = 'scaleX(1)'; setState('walk'); }
            if (pos > vw-44) { dir = -1; bear.style.transform = 'scaleX(-1)'; setState('walk'); }
            bear.style.left = pos + 'px';
            // step animation
            if (state === 'walk' && Math.random() < 0.012) {
                setState('idle');
                idleTimeout = 800 + Math.random()*1200;
                idleTimer = 0;
            }
            if (state === 'walk') {
                animFrame = requestAnimationFrame(walkLoop);
            } else if (state === 'idle') {
                idleTimer += 16;
                if (idleTimer > idleTimeout) {
                    setState(randomIdle());
                    setTimeout(()=>{
                        setState('walk');
                        animFrame = requestAnimationFrame(walkLoop);
                    }, 900);
                } else {
                    animFrame = requestAnimationFrame(walkLoop);
                }
            } else if (state === 'wave' || state === 'sit' || state === 'jump') {
                setTimeout(()=>{
                    setState('walk');
                    animFrame = requestAnimationFrame(walkLoop);
                }, 900);
            }
        }
        function resizeBear() {
            vw = window.innerWidth;
            if (pos > vw-44) pos = vw-44;
        }
        window.addEventListener('resize', resizeBear);
        setState('walk');
        bear.style.left = pos + 'px';
        bear.style.bottom = '1.5vh';
        bear.addEventListener('click', function(e){
            e.stopPropagation();
            setState('smile');
            bear.classList.add('love');
            setTimeout(()=>{
                bear.classList.remove('love');
                setState('walk');
            }, 900);
        });
        walkLoop();
    })();

    // --- Kawaii Bird Animation ---
    (function(){
        const bird = document.getElementById('kawaiiBird');
        bird.innerHTML = `
        <div class="bird-shadow"></div>
        <svg class="bird-svg" viewBox="0 0 32 32">
            <ellipse class="bird-body" cx="16" cy="18" rx="10" ry="8" fill="#b3e0ff"/>
            <ellipse class="bird-face" cx="16" cy="18" rx="7" ry="6" fill="#fff"/>
            <ellipse class="bird-eye-left" cx="13" cy="18" rx="0.8" ry="0.8" fill="#3a5ca8"/>
            <ellipse class="bird-eye-right" cx="19" cy="18" rx="0.8" ry="0.8" fill="#3a5ca8"/>
            <ellipse class="bird-beak" cx="16" cy="21" rx="1.2" ry="0.5" fill="#ffd700"/>
            <ellipse class="bird-leg-left" cx="13" cy="28" rx="0.7" ry="2" fill="#ffd6ec"/>
            <ellipse class="bird-leg-right" cx="19" cy="28" rx="0.7" ry="2" fill="#ffd6ec"/>
            <ellipse class="bird-wing" cx="23" cy="20" rx="3" ry="2" fill="#e3f6ff"/>
        </svg>
        `;
        let state = 'walk';
        let dir = 1;
        let pos = 0;
        let vw = window.innerWidth;
        let idleTimer = 0;
        let idleTimeout = 0;
        let animFrame;
        function setState(s) {
            bird.classList.remove('walk','idle','flap','jump');
            bird.classList.add(s);
            state = s;
        }
        function randomIdle() {
            return Math.random() < 0.5 ? 'flap' : 'jump';
        }
        function walkLoop() {
            pos += dir * 0.8 * (window.innerWidth/900+0.7);
            if (pos < 0) { dir = 1; bird.style.transform = 'scaleX(1)'; setState('walk'); }
            if (pos > vw-32) { dir = -1; bird.style.transform = 'scaleX(-1)'; setState('walk'); }
            bird.style.left = pos + 'px';
            // step animation
            if (state === 'walk' && Math.random() < 0.012) {
                setState('idle');
                idleTimeout = 600 + Math.random()*900;
                idleTimer = 0;
            }
            if (state === 'walk') {
                animFrame = requestAnimationFrame(walkLoop);
            } else if (state === 'idle') {
                idleTimer += 16;
                if (idleTimer > idleTimeout) {
                    setState(randomIdle());
                    setTimeout(()=>{
                        setState('walk');
                        animFrame = requestAnimationFrame(walkLoop);
                    }, 700);
                } else {
                    animFrame = requestAnimationFrame(walkLoop);
                }
            } else if (state === 'flap' || state === 'jump') {
                setTimeout(()=>{
                    setState('walk');
                    animFrame = requestAnimationFrame(walkLoop);
                }, 700);
            }
        }
        function resizeBird() {
            vw = window.innerWidth;
            if (pos > vw-32) pos = vw-32;
        }
        window.addEventListener('resize', resizeBird);
        setState('walk');
        bird.style.left = pos + 'px';
        bird.style.bottom = '7vh';
        walkLoop();
    })();

    // --- Treasure Box Animation ---
    (function(){
        const btn = document.getElementById('treasureBtn');
        const box = document.getElementById('treasureBoxAnim');
        const gold = box.querySelector('.treasure-gold');
        const coins = box.querySelector('.treasure-coins');
        const sparkle = box.querySelector('.treasure-sparkle');
        let open = false;
        btn.addEventListener('click', function(){
            if(open) return;
            open = true;
            box.classList.add('open');
            // Gold glow
            gold.style.opacity = 1;
            // Coins animation
            coins.innerHTML = '';
            for(let i=0;i<7;i++){
                let c = document.createElement('div');
                c.style.position='absolute';
                c.style.left=(12+i*4)+'px';
                c.style.bottom='0px';
                c.style.width='8px';c.style.height='8px';
                c.style.borderRadius='50%';
                c.style.background='radial-gradient(circle at 60% 40%,#ffd700 70%,#ffe066 100%)';
                c.style.opacity='0';
                c.style.transform=`translateY(0) scale(1)`;
                coins.appendChild(c);
                setTimeout(()=>{
                    c.style.transition='all 0.7s cubic-bezier(.6,0,.4,1)';
                    c.style.opacity='1';
                    c.style.transform=`translateY(-${24+Math.random()*16}px) scale(${0.9+Math.random()*0.3})`;
                },200+Math.random()*200);
                setTimeout(()=>{
                    c.style.opacity='0';
                },1200+Math.random()*200);
            }
            // Sparkle
            sparkle.innerHTML = '';
            for(let i=0;i<6;i++){
                let s = document.createElement('div');
                s.style.position='absolute';
                s.style.left=(10+Math.random()*24)+'px';
                s.style.top=(2+Math.random()*16)+'px';
                s.style.width='10px';s.style.height='10px';
                s.style.borderRadius='50%';
                s.style.background='radial-gradient(circle,#fff 60%,#ffd700 100%)';
                s.style.opacity='0.7';
                s.style.animation=`sparkleFade 0.7s ${0.2+Math.random()*0.3}s forwards`;
                sparkle.appendChild(s);
                setTimeout(()=>{s.remove();},1000);
            }
            // Confetti gold
            triggerGoldConfetti();
            // Sound (optional)
            try {
                let audio = new Audio("https://cdn.pixabay.com/audio/2022/03/15/audio_115b7b2e7b.mp3");
                audio.volume = 0.18;
                audio.play();
            } catch{}
            setTimeout(() => {
                box.classList.remove('open');
                gold.style.opacity = 0;
                coins.innerHTML = '';
                sparkle.innerHTML = '';
                open = false;
            }, 1800);
        });
        // Gold confetti
        function triggerGoldConfetti() {
            const canvas = document.createElement('canvas');
            canvas.width = 120;
            canvas.height = 60;
            canvas.style.position = 'absolute';
            canvas.style.left = '-30px';
            canvas.style.top = '-30px';
            canvas.style.pointerEvents = 'none';
            canvas.style.zIndex = 10;
            box.appendChild(canvas);
            const ctx = canvas.getContext('2d');
            let confettiArr = [];
            for(let i=0;i<18;i++){
                confettiArr.push({
                    x: 60+Math.random()*20-10,
                    y: 24,
                    r: 3+Math.random()*2,
                    c: Math.random()>0.5?'#ffd700':'#ffe066',
                    vy: -2-Math.random()*2,
                    vx: -2+Math.random()*4,
                    a: Math.random()*Math.PI*2
                });
            }
            let frame=0;
            function drawConfetti(){
                ctx.clearRect(0,0,canvas.width,canvas.height);
                confettiArr.forEach(cf=>{
                    ctx.save();
                    ctx.translate(cf.x,cf.y);
                    ctx.rotate(cf.a+frame*0.03);
                    ctx.fillStyle=cf.c;
                    ctx.beginPath();
                    ctx.arc(0,0,cf.r,0,Math.PI*2);
                    ctx.fill();
                    ctx.restore();
                    cf.x+=cf.vx;
                    cf.y+=cf.vy;
                    cf.vy+=0.13;
                });
                frame++;
                confettiArr = confettiArr.filter(cf=>cf.y<canvas.height+20);
                if(confettiArr.length>0){
                    requestAnimationFrame(drawConfetti);
                } else {
                    canvas.remove();
                }
            }
            drawConfetti();
        }
    })();
    </script>
</body>
</html>